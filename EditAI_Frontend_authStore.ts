import { create } from 'zustand';\nimport axios from 'axios';\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  subscription_tier: 'free' | 'pro' | 'team';\n}\n\ninterface AuthStore {\n  user: User | null;\n  token: string | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  error: string | null;\n\n  register: (email: string, password: string, name: string) => Promise<void>;\n  login: (email: string, password: string) => Promise<void>;\n  logout: () => void;\n  checkAuth: () => Promise<void>;\n  clearError: () => void;\n}\n\nconst API_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000';\n\nexport const useAuthStore = create<AuthStore>((set) => ({\n  user: null,\n  token: localStorage.getItem('token'),\n  isAuthenticated: !!localStorage.getItem('token'),\n  isLoading: false,\n  error: null,\n\n  register: async (email: string, password: string, name: string) => {\n    set({ isLoading: true, error: null });\n    try {\n      const response = await axios.post(`${API_URL}/api/auth/register`, {\n        email,\n        password,\n        name,\n      });\n\n      const { user, token } = response.data;\n      localStorage.setItem('token', token);\n\n      set({\n        user,\n        token,\n        isAuthenticated: true,\n        isLoading: false,\n      });\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Registration failed';\n      set({ error: message, isLoading: false });\n      throw new Error(message);\n    }\n  },\n\n  login: async (email: string, password: string) => {\n    set({ isLoading: true, error: null });\n    try {\n      const response = await axios.post(`${API_URL}/api/auth/login`, {\n        email,\n        password,\n      });\n\n      const { user, token } = response.data;\n      localStorage.setItem('token', token);\n\n      set({\n        user,\n        token,\n        isAuthenticated: true,\n        isLoading: false,\n      });\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Login failed';\n      set({ error: message, isLoading: false });\n      throw new Error(message);\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('token');\n    set({\n      user: null,\n      token: null,\n      isAuthenticated: false,\n    });\n  },\n\n  checkAuth: async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      set({ isAuthenticated: false });\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_URL}/api/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      set({\n        user: response.data,\n        token,\n        isAuthenticated: true,\n      });\n    } catch (err) {\n      localStorage.removeItem('token');\n      set({\n        user: null,\n        token: null,\n        isAuthenticated: false,\n      });\n    }\n  },\n\n  clearError: () => set({ error: null }),\n}));\n
