import { create } from 'zustand';\nimport axios from 'axios';\n\nexport interface EditPlan {\n  id: string;\n  title: string;\n  video_title?: string;\n  command: string;\n  plan_json: {\n    plan_id: string;\n    title: string;\n    scenes: Scene[];\n    captions: Caption[];\n    animations: Animation[];\n    transitions?: Transition[];\n  };\n  status: 'pending' | 'completed' | 'failed';\n  created_at: string;\n}\n\nexport interface Scene {\n  id: string;\n  start_time: string;\n  end_time: string;\n  action: 'KEEP' | 'CUT' | 'TRIM' | 'SLOW' | 'SPEED';\n  reason?: string;\n}\n\nexport interface Caption {\n  id: string;\n  time: string;\n  text: string;\n  style: string;\n  duration: string;\n}\n\nexport interface Animation {\n  id: string;\n  type: string;\n  duration: string;\n  timing: string;\n  properties?: Record<string, any>;\n}\n\nexport interface Transition {\n  id: string;\n  type: string;\n  duration: string;\n}\n\ninterface EditPlanStore {\n  currentPlan: EditPlan | null;\n  plans: EditPlan[];\n  isLoading: boolean;\n  error: string | null;\n  \n  generatePlan: (command: string, videoTitle?: string) => Promise<void>;\n  fetchPlans: () => Promise<void>;\n  fetchPlan: (id: string) => Promise<void>;\n  deletePlan: (id: string) => Promise<void>;\n  clearError: () => void;\n}\n\nconst API_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000';\n\nexport const useEditPlanStore = create<EditPlanStore>((set, get) => ({\n  currentPlan: null,\n  plans: [],\n  isLoading: false,\n  error: null,\n\n  generatePlan: async (command: string, videoTitle?: string) => {\n    set({ isLoading: true, error: null });\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.post(\n        `${API_URL}/api/plans/generate`,\n        {\n          command,\n          video_title: videoTitle,\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n\n      const plan = response.data;\n      set((state) => ({\n        currentPlan: plan,\n        plans: [plan, ...state.plans],\n        isLoading: false,\n      }));\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Failed to generate plan';\n      set({ error: message, isLoading: false });\n      throw new Error(message);\n    }\n  },\n\n  fetchPlans: async () => {\n    set({ isLoading: true });\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`${API_URL}/api/plans`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      set({ plans: response.data, isLoading: false });\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Failed to fetch plans';\n      set({ error: message, isLoading: false });\n    }\n  },\n\n  fetchPlan: async (id: string) => {\n    set({ isLoading: true });\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.get(`${API_URL}/api/plans/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      set({ currentPlan: response.data, isLoading: false });\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Failed to fetch plan';\n      set({ error: message, isLoading: false });\n    }\n  },\n\n  deletePlan: async (id: string) => {\n    try {\n      const token = localStorage.getItem('token');\n      await axios.delete(`${API_URL}/api/plans/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      set((state) => ({\n        plans: state.plans.filter((p) => p.id !== id),\n        currentPlan: state.currentPlan?.id === id ? null : state.currentPlan,\n      }));\n    } catch (err: any) {\n      const message = err.response?.data?.error || 'Failed to delete plan';\n      set({ error: message });\n    }\n  },\n\n  clearError: () => set({ error: null }),\n}));\n
